<!DOCTYPE html>

<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>X æ¨ç‰¹ä¼˜åŒ–å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: #0a0e27;
        color: #fff;
        min-height: 100vh;
        overflow-x: hidden;
    }

    .bg-animation {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
            radial-gradient(ellipse at top, #1e3a8a 0%, transparent 50%),
            radial-gradient(ellipse at bottom, #7c3aed 0%, transparent 50%),
            linear-gradient(180deg, #0a0e27 0%, #1a1f3a 100%);
        z-index: 0;
    }

    .container {
        position: relative;
        z-index: 1;
        max-width: 900px;
        margin: 0 auto;
        padding: 0;
    }

    .header {
        background: rgba(10, 14, 39, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(124, 58, 237, 0.3);
        padding: 15px 20px;
        position: sticky;
        top: 0;
        z-index: 100;
    }

    .header-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .logo {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .logo-icon {
        font-size: 24px;
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }

    .logo-text h1 {
        font-size: 1.2em;
        background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 700;
    }

    .logo-text .subtitle {
        font-size: 0.7em;
        color: #64748b;
        margin-top: -2px;
    }

    .creator-badge {
        background: linear-gradient(135deg, #7c3aed 0%, #00d4ff 100%);
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.7em;
        font-weight: 600;
        box-shadow: 0 0 20px rgba(124, 58, 237, 0.5);
    }

    .content {
        padding: 15px;
    }

    .card {
        background: rgba(15, 23, 42, 0.6);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(124, 58, 237, 0.3);
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 15px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        transition: all 0.3s;
    }

    .card:hover {
        border-color: rgba(0, 212, 255, 0.5);
        box-shadow: 0 8px 32px rgba(0, 212, 255, 0.2);
    }

    .card-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 15px;
        padding-bottom: 12px;
        border-bottom: 1px solid rgba(124, 58, 237, 0.2);
    }

    .card-icon {
        width: 32px;
        height: 32px;
        background: linear-gradient(135deg, #7c3aed 0%, #00d4ff 100%);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
    }

    .card-title {
        font-size: 1.1em;
        font-weight: 700;
        background: linear-gradient(135deg, #fff 0%, #00d4ff 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .input-group {
        margin-bottom: 15px;
    }

    .input-label {
        display: block;
        margin-bottom: 8px;
        color: #94a3b8;
        font-size: 0.9em;
        font-weight: 600;
    }

    textarea, input[type="text"] {
        width: 100%;
        padding: 12px 15px;
        background: rgba(30, 41, 59, 0.5);
        border: 2px solid rgba(124, 58, 237, 0.3);
        border-radius: 12px;
        color: #fff;
        font-size: 15px;
        font-family: inherit;
        transition: all 0.3s;
    }

    textarea {
        min-height: 100px;
        resize: vertical;
    }

    textarea:focus, input[type="text"]:focus {
        outline: none;
        border-color: #00d4ff;
        background: rgba(30, 41, 59, 0.8);
        box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
    }

    textarea::placeholder, input[type="text"]::placeholder {
        color: #475569;
    }

    .char-count {
        text-align: right;
        color: #64748b;
        font-size: 12px;
        margin-top: 5px;
        font-weight: 600;
    }

    .char-count.warning { color: #fbbf24; }
    .char-count.error { color: #ef4444; }

    .btn {
        width: 100%;
        padding: 14px 20px;
        background: linear-gradient(135deg, #7c3aed 0%, #00d4ff 100%);
        border: none;
        border-radius: 12px;
        color: #fff;
        font-size: 15px;
        font-weight: 700;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        transition: all 0.3s;
        box-shadow: 0 4px 20px rgba(124, 58, 237, 0.4);
    }

    .btn:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 6px 30px rgba(0, 212, 255, 0.6);
    }

    .btn:active:not(:disabled) {
        transform: translateY(0);
    }

    .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .btn-success {
        background: linear-gradient(135deg, #10b981 0%, #00d4ff 100%);
    }

    .btn-secondary {
        background: linear-gradient(135deg, #64748b 0%, #475569 100%);
    }

    .metrics {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin: 15px 0;
    }

    .metric-card {
        background: rgba(30, 41, 59, 0.5);
        border: 1px solid rgba(124, 58, 237, 0.3);
        border-radius: 12px;
        padding: 12px 8px;
        text-align: center;
        transition: all 0.3s;
    }

    .metric-card:hover {
        border-color: #00d4ff;
        transform: translateY(-2px);
    }

    .metric-value {
        font-size: 1.8em;
        font-weight: 700;
        background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 4px;
    }

    .metric-label {
        color: #94a3b8;
        font-size: 0.75em;
        font-weight: 600;
    }

    .score-circle {
        width: 120px;
        height: 120px;
        margin: 20px auto;
        border-radius: 50%;
        background: conic-gradient(
            #00d4ff 0deg,
            #00d4ff calc(var(--score) * 3.6deg),
            rgba(30, 41, 59, 0.5) calc(var(--score) * 3.6deg)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        box-shadow: 0 0 30px rgba(0, 212, 255, 0.3);
    }

    .score-circle::before {
        content: '';
        width: 95px;
        height: 95px;
        background: #0f172a;
        border-radius: 50%;
        position: absolute;
    }

    .score-text {
        font-size: 2.2em;
        font-weight: 700;
        background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        z-index: 1;
    }

    .suggestions {
        background: rgba(30, 41, 59, 0.3);
        border: 1px solid rgba(124, 58, 237, 0.2);
        border-radius: 12px;
        padding: 15px;
        margin-top: 15px;
    }

    .suggestions-title {
        color: #00d4ff;
        font-size: 0.95em;
        font-weight: 700;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .suggestion-item {
        background: rgba(15, 23, 42, 0.6);
        border-left: 3px solid #7c3aed;
        border-radius: 8px;
        padding: 10px 12px;
        margin-bottom: 8px;
        font-size: 0.88em;
        color: #cbd5e1;
        line-height: 1.5;
    }

    .suggestion-item:last-child {
        margin-bottom: 0;
    }

    .alert {
        padding: 12px 15px;
        border-radius: 12px;
        margin-bottom: 15px;
        font-size: 0.88em;
        border-left: 4px solid;
    }

    .alert-info {
        background: rgba(0, 212, 255, 0.1);
        border-color: #00d4ff;
        color: #7dd3fc;
    }

    .alert-success {
        background: rgba(16, 185, 129, 0.1);
        border-color: #10b981;
        color: #6ee7b7;
    }

    .alert-warning {
        background: rgba(251, 191, 36, 0.1);
        border-color: #fbbf24;
        color: #fcd34d;
    }

    .alert-danger {
        background: rgba(239, 68, 68, 0.1);
        border-color: #ef4444;
        color: #fca5a5;
    }

    .tabs {
        display: flex;
        gap: 5px;
        margin-bottom: 15px;
        border-bottom: 2px solid rgba(124, 58, 237, 0.3);
    }

    .tab {
        padding: 10px 16px;
        background: none;
        border: none;
        border-bottom: 3px solid transparent;
        color: #64748b;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        font-size: 0.9em;
    }

    .tab.active {
        color: #00d4ff;
        border-bottom-color: #00d4ff;
    }

    .tab-content {
        display: none;
    }

    .tab-content.active {
        display: block;
    }

    .btn-group {
        display: flex;
        gap: 10px;
        margin-top: 15px;
    }

    .spinner {
        border: 3px solid rgba(124, 58, 237, 0.3);
        border-top: 3px solid #00d4ff;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .loading-text {
        color: #94a3b8;
        margin-top: 12px;
        font-size: 0.9em;
        text-align: center;
    }

    .diagnosis-options {
        margin: 15px 0;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .option-card {
        background: rgba(30, 41, 59, 0.5);
        border: 2px solid rgba(124, 58, 237, 0.3);
        border-radius: 12px;
        padding: 12px 15px;
        cursor: pointer;
        transition: all 0.3s;
    }

    .option-card:hover {
        border-color: #00d4ff;
        background: rgba(30, 41, 59, 0.7);
    }

    .option-card.selected {
        border-color: #00d4ff;
        background: rgba(0, 212, 255, 0.1);
    }

    .option-header {
        display: flex;
        align-items: flex-start;
        gap: 10px;
    }

    .option-header input[type="radio"] {
        margin-top: 3px;
        cursor: pointer;
    }

    .option-header label {
        flex: 1;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .option-header label strong {
        color: #fff;
        font-size: 0.95em;
    }

    .option-header label span {
        color: #94a3b8;
        font-size: 0.85em;
    }

    .grok-prompt-box {
        background: rgba(30, 41, 59, 0.6);
        border: 2px solid #7c3aed;
        border-radius: 12px;
        padding: 15px;
        margin-top: 15px;
    }

    .grok-prompt-box h4 {
        color: #00d4ff;
        margin-bottom: 10px;
        font-size: 0.95em;
    }

    .prompt-text {
        background: rgba(15, 23, 42, 0.8);
        border: 1px solid rgba(124, 58, 237, 0.3);
        border-radius: 8px;
        padding: 12px;
        color: #cbd5e1;
        font-size: 0.85em;
        line-height: 1.6;
        font-family: 'Courier New', monospace;
        white-space: pre-wrap;
        word-wrap: break-word;
        max-height: 300px;
        overflow-y: auto;
    }

    .copy-prompt-btn {
        margin-top: 10px;
        background: linear-gradient(135deg, #7c3aed 0%, #00d4ff 100%);
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        color: white;
        font-weight: 600;
        cursor: pointer;
        font-size: 0.85em;
        width: 100%;
        transition: all 0.3s;
    }

    .copy-prompt-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0, 212, 255, 0.4);
    }

    .grok-link {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        color: #00d4ff;
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9em;
        margin-top: 10px;
        padding: 8px 15px;
        background: rgba(0, 212, 255, 0.1);
        border-radius: 8px;
        transition: all 0.3s;
    }

    .grok-link:hover {
        background: rgba(0, 212, 255, 0.2);
        transform: translateX(5px);
    }

    .retweet-prompt {
        background: linear-gradient(135deg, rgba(124, 58, 237, 0.2) 0%, rgba(0, 212, 255, 0.2) 100%);
        border: 2px solid #7c3aed;
        border-radius: 16px;
        padding: 20px;
        margin-top: 15px;
        text-align: center;
    }

    .retweet-prompt h3 {
        color: #00d4ff;
        font-size: 1.1em;
        margin-bottom: 15px;
    }

    .retweet-prompt p {
        color: #cbd5e1;
        font-size: 0.9em;
        line-height: 1.6;
        margin-bottom: 20px;
    }

    .retweet-btn {
        background: linear-gradient(135deg, #1DA1F2 0%, #00d4ff 100%);
        border: none;
        padding: 14px 30px;
        border-radius: 12px;
        color: white;
        font-weight: 700;
        font-size: 1em;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s;
        box-shadow: 0 4px 20px rgba(29, 161, 242, 0.4);
    }

    .retweet-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 30px rgba(0, 212, 255, 0.6);
    }

    .retweet-info {
        margin-top: 15px;
        padding: 12px;
        background: rgba(30, 41, 59, 0.5);
        border-radius: 8px;
        font-size: 0.85em;
        color: #94a3b8;
    }

    .verified-badge {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        background: rgba(16, 185, 129, 0.2);
        color: #10b981;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85em;
        font-weight: 600;
        margin-top: 10px;
    }

    .influence-frame-container {
        background: rgba(30, 41, 59, 0.5);
        border: 2px solid rgba(124, 58, 237, 0.3);
        border-radius: 16px;
        overflow: hidden;
        margin-top: 15px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .influence-header {
        background: rgba(124, 58, 237, 0.2);
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid rgba(124, 58, 237, 0.3);
    }

    .influence-header h4 {
        color: #00d4ff;
        font-size: 1em;
        margin: 0;
    }

    .open-full-link {
        display: flex;
        align-items: center;
        gap: 5px;
        color: #94a3b8;
        text-decoration: none;
        font-size: 0.85em;
        transition: all 0.3s;
        padding: 5px 12px;
        border-radius: 8px;
        background: rgba(30, 41, 59, 0.5);
    }

    .open-full-link:hover {
        color: #00d4ff;
        background: rgba(0, 212, 255, 0.1);
    }

    .influence-frame {
        width: 100%;
        height: 600px;
        border: none;
        display: block;
        background: #fff;
    }

    .influence-footer {
        background: rgba(15, 23, 42, 0.8);
        padding: 10px 20px;
        text-align: center;
        border-top: 1px solid rgba(124, 58, 237, 0.3);
    }

    .influence-footer small {
        color: #94a3b8;
        font-size: 0.8em;
    }

    .influence-footer a {
        color: #00d4ff;
        text-decoration: none;
    }

    .influence-footer a:hover {
        text-decoration: underline;
    }

    @media (max-width: 600px) {
        .header {
            padding: 12px 15px;
        }

        .logo-text h1 {
            font-size: 1.1em;
        }

        .creator-badge {
            font-size: 0.65em;
            padding: 3px 10px;
        }

        .content {
            padding: 10px;
        }

        .card {
            padding: 15px;
        }

        .influence-frame {
            height: 500px;
        }

        .influence-header {
            flex-direction: column;
            gap: 10px;
            align-items: flex-start;
        }
    }
</style>
```

</head>
<body>
    <div class="bg-animation"></div>

```
<div class="container">
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">ğŸš€</div>
                <div class="logo-text">
                    <h1>X æ¨ç‰¹ä¼˜åŒ–å™¨</h1>
                    <div class="subtitle">AI-Powered Optimizer</div>
                </div>
            </div>
            <div class="creator-badge">å¸ä¸–ç‹</div>
        </div>
    </div>

    <div class="content">
        <div class="card">
            <div class="card-header">
                <div class="card-icon">âœ¨</div>
                <div class="card-title">æ¨æ–‡ä¼˜åŒ–</div>
            </div>

            <div class="input-group">
                <label class="input-label">è¾“å…¥ä½ çš„æ¨æ–‡å†…å®¹</label>
                <textarea id="tweetInput" placeholder="åœ¨è¿™é‡Œè¾“å…¥ä½ æƒ³å‘å¸ƒçš„æ¨æ–‡å†…å®¹..."></textarea>
                <div class="char-count" id="charCount">0 / 280</div>
            </div>

            <button class="btn" id="analyzeBtn" onclick="analyzeTweet()">
                <span>ğŸ”</span>
                <span>åˆ†æå¹¶ä¼˜åŒ–</span>
            </button>

            <div id="optimizationResults"></div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="card-icon">ğŸ¥</div>
                <div class="card-title">è´¦å·å¥åº·è¯Šæ–­</div>
            </div>

            <div class="alert alert-info">
                ğŸ’¡ åŸºäº X Algorithm çš„æ·±åº¦è´¦å·åˆ†æ
            </div>

            <div class="input-group">
                <label class="input-label">ä½ çš„ X ç”¨æˆ·å</label>
                <input type="text" id="xUsername" placeholder="@your_username">
            </div>

            <button class="btn" style="margin-bottom: 15px;" onclick="checkInfluenceScore()">
                <span>ğŸ“Š</span>
                <span>æŸ¥çœ‹å½±å“åŠ›æŒ‡æ•° (Sorsa.io)</span>
            </button>

            <div id="influenceResults"></div>

            <div class="diagnosis-options">
                <div class="option-card selected" onclick="selectDiagnosisMode('basic')">
                    <div class="option-header">
                        <input type="radio" name="diagMode" id="basicMode" checked>
                        <label for="basicMode">
                            <strong>ğŸ” åŸºç¡€åˆ†æ</strong>
                            <span>æœ¬åœ°ç®—æ³•å¿«é€Ÿè¯Šæ–­</span>
                        </label>
                    </div>
                </div>
                <div class="option-card" onclick="selectDiagnosisMode('grok')">
                    <div class="option-header">
                        <input type="radio" name="diagMode" id="grokMode">
                        <label for="grokMode">
                            <strong>ğŸ¤– Grok AI æ·±åº¦åˆ†æ</strong>
                            <span>AI è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šæŠ¥å‘Š</span>
                        </label>
                    </div>
                </div>
            </div>

            <button class="btn" id="diagnoseBtn" onclick="diagnoseAccount()">
                <span>ğŸ”¬</span>
                <span>å¼€å§‹è¯Šæ–­</span>
            </button>

            <div id="retweetPrompt" style="display: none;"></div>

            <div id="healthResults"></div>
            <div id="grokPrompt" style="display: none;"></div>
        </div>

        <div class="card" id="previewCard" style="display: none;">
            <div class="card-header">
                <div class="card-icon">ğŸ“Š</div>
                <div class="card-title">ä¼˜åŒ–ç»“æœ</div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="switchTab('original')">åŸå§‹</button>
                <button class="tab" onclick="switchTab('optimized')">ä¼˜åŒ–</button>
                <button class="tab" onclick="switchTab('comparison')">å¯¹æ¯”</button>
            </div>

            <div class="tab-content active" id="originalTab">
                <div class="input-group">
                    <label class="input-label">åŸå§‹æ¨æ–‡</label>
                    <textarea id="originalTweet" readonly style="background: rgba(30, 41, 59, 0.3);"></textarea>
                </div>
            </div>

            <div class="tab-content" id="optimizedTab">
                <div class="input-group">
                    <label class="input-label">ä¼˜åŒ–åçš„æ¨æ–‡</label>
                    <textarea id="optimizedTweet"></textarea>
                    <div class="char-count" id="optimizedCharCount">0 / 280</div>
                </div>
            </div>

            <div class="tab-content" id="comparisonTab">
                <div class="metrics">
                    <div class="metric-card">
                        <div class="metric-value" id="engagementScore">0%</div>
                        <div class="metric-label">äº’åŠ¨ç‡</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="viralScore">0%</div>
                        <div class="metric-label">ä¼ æ’­åŠ›</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="qualityScore">0%</div>
                        <div class="metric-label">è´¨é‡åˆ†</div>
                    </div>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-success" onclick="postToTwitter()" style="flex: 2;">
                    <span>ğŸš€</span>
                    <span>å‘å¸ƒåˆ° X</span>
                </button>
                <button class="btn btn-secondary" onclick="copyToClipboard()" style="flex: 1;">
                    <span>ğŸ“‹</span>
                    <span>å¤åˆ¶</span>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    const tweetInput = document.getElementById('tweetInput');
    const charCount = document.getElementById('charCount');

    tweetInput.addEventListener('input', updateCharCount);

    function updateCharCount() {
        const length = tweetInput.value.length;
        charCount.textContent = `${length} / 280`;
        
        if (length > 280) {
            charCount.classList.add('error');
            charCount.classList.remove('warning');
        } else if (length > 260) {
            charCount.classList.add('warning');
            charCount.classList.remove('error');
        } else {
            charCount.classList.remove('warning', 'error');
        }
    }

    const optimizedTweet = document.getElementById('optimizedTweet');
    const optimizedCharCount = document.getElementById('optimizedCharCount');

    optimizedTweet.addEventListener('input', function() {
        const length = this.value.length;
        optimizedCharCount.textContent = `${length} / 280`;
        
        if (length > 280) {
            optimizedCharCount.classList.add('error');
            optimizedCharCount.classList.remove('warning');
        } else if (length > 260) {
            optimizedCharCount.classList.add('warning');
            optimizedCharCount.classList.remove('error');
        } else {
            optimizedCharCount.classList.remove('warning', 'error');
        }
    });

    function analyzeTweet() {
        const tweetInput = document.getElementById('tweetInput');
        if (!tweetInput) {
            console.error('Tweet input element not found');
            return;
        }
        
        const tweet = tweetInput.value.trim();
        
        if (!tweet) {
            showAlert('optimizationResults', 'âš ï¸ è¯·è¾“å…¥æ¨æ–‡å†…å®¹', 'warning');
            return;
        }

        if (tweet.length > 280) {
            showAlert('optimizationResults', 'âŒ æ¨æ–‡é•¿åº¦è¶…è¿‡280å­—ç¬¦', 'danger');
            return;
        }

        const analyzeBtn = document.getElementById('analyzeBtn');
        analyzeBtn.disabled = true;
        
        showLoading('optimizationResults', 'æ­£åœ¨åˆ†ææ¨æ–‡...');

        setTimeout(() => {
            const result = analyzeWithAlgorithm(tweet);
            displayOptimizationResults(result, tweet);
            analyzeBtn.disabled = false;
        }, 1200);
    }

    function analyzeWithAlgorithm(tweet) {
        let engagement_score = 50;
        let viral_potential = 50;
        let quality_score = 50;
        let suggestions = [];
        let optimized = tweet;

        if (tweet.length < 50) {
            suggestions.push("æ¨æ–‡å¤ªçŸ­ï¼Œå»ºè®®80-180å­—ç¬¦æé«˜äº’åŠ¨");
            quality_score -= 15;
        } else if (tweet.length > 200) {
            suggestions.push("æ¨æ–‡è¾ƒé•¿ï¼Œè€ƒè™‘åˆ†æ®µæé«˜å¯è¯»æ€§");
            quality_score -= 10;
        } else {
            engagement_score += 15;
        }

        if (tweet.includes('?') || tweet.includes('ï¼Ÿ')) {
            engagement_score += 20;
            viral_potential += 15;
            suggestions.push("âœ… åŒ…å«é—®é¢˜å¯æé«˜äº’åŠ¨ç‡");
        } else {
            suggestions.push("æ·»åŠ é—®é¢˜å¯é¼“åŠ±ç”¨æˆ·å›å¤è®¨è®º");
        }

        const emojiRegex = /[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F1E0}-\u{1F1FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}]/u;
        if (emojiRegex.test(tweet)) {
            engagement_score += 10;
            viral_potential += 10;
            suggestions.push("âœ… Emojiä½¿ç”¨å¾—å½“ï¼Œæé«˜å¯è§åº¦");
        } else {
            suggestions.push("æ·»åŠ ç›¸å…³emojiæé«˜å¸å¼•åŠ›");
        }

        if (tweet.includes('#')) {
            const hashtagCount = (tweet.match(/#/g) || []).length;
            if (hashtagCount <= 3) {
                engagement_score += 15;
                viral_potential += 20;
                suggestions.push("âœ… è¯é¢˜æ ‡ç­¾ä½¿ç”¨åˆç†");
            } else {
                engagement_score -= 10;
                suggestions.push("è¯é¢˜æ ‡ç­¾è¿‡å¤šï¼Œå»ºè®®1-3ä¸ª");
            }
        } else {
            suggestions.push("æ·»åŠ 1-2ä¸ªè¯é¢˜æ ‡ç­¾æ‰©å¤§å—ä¼—");
        }

        if (tweet.includes('@')) {
            engagement_score += 10;
            suggestions.push("âœ… @æåŠæœ‰åŠ©äºäº’åŠ¨");
        }

        if (tweet.includes('http')) {
            engagement_score += 5;
            quality_score += 10;
            suggestions.push("âœ… åŒ…å«é“¾æ¥æä¾›æ›´å¤šä»·å€¼");
        }

        let optimizedParts = [];
        
        if (!emojiRegex.test(tweet)) {
            const emojis = ['ğŸ”¥', 'ğŸ’¡', 'ğŸš€', 'âœ¨', 'ğŸ“ˆ', 'ğŸ¯'];
            optimizedParts.push(emojis[Math.floor(Math.random() * emojis.length)]);
        }
        
        optimizedParts.push(tweet);
        
        if (!tweet.includes('?') && !tweet.includes('ï¼Ÿ') && tweet.length < 240) {
            optimizedParts.push('\n\nä½ æ€ä¹ˆçœ‹ï¼Ÿ');
        }
        
        if (!tweet.includes('#') && tweet.length < 250) {
            optimizedParts.push(' #åˆ†äº«');
        }

        optimized = optimizedParts.join(' ').trim();
        if (optimized.length > 280) optimized = tweet;

        engagement_score = Math.max(20, Math.min(95, engagement_score));
        viral_potential = Math.max(20, Math.min(95, viral_potential));
        quality_score = Math.max(20, Math.min(95, quality_score));

        return {
            engagement_score,
            viral_potential,
            quality_score,
            suggestions: suggestions.slice(0, 3),
            optimized_tweet: optimized
        };
    }

    function displayOptimizationResults(result, originalTweet) {
        const resultsDiv = document.getElementById('optimizationResults');
        
        resultsDiv.innerHTML = `
            <div class="metrics" style="margin-top: 15px;">
                <div class="metric-card">
                    <div class="metric-value">${result.engagement_score}</div>
                    <div class="metric-label">äº’åŠ¨åˆ†</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${result.viral_potential}</div>
                    <div class="metric-label">ä¼ æ’­åŠ›</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${result.quality_score}</div>
                    <div class="metric-label">è´¨é‡åˆ†</div>
                </div>
            </div>

            <div class="suggestions">
                <div class="suggestions-title">ğŸ’¡ ä¼˜åŒ–å»ºè®®</div>
                ${result.suggestions.map(s => `
                    <div class="suggestion-item">${s}</div>
                `).join('')}
            </div>
        `;

        document.getElementById('previewCard').style.display = 'block';
        document.getElementById('originalTweet').value = originalTweet;
        document.getElementById('optimizedTweet').value = result.optimized_tweet;
        
        optimizedCharCount.textContent = `${result.optimized_tweet.length} / 280`;
        
        document.getElementById('engagementScore').textContent = `${result.engagement_score}%`;
        document.getElementById('viralScore').textContent = `${result.viral_potential}%`;
        document.getElementById('qualityScore').textContent = `${result.quality_score}%`;

        setTimeout(() => {
            document.getElementById('previewCard').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
    }

    let hasClickedTweet = false;

    // æŸ¥çœ‹å½±å“åŠ›æŒ‡æ•°
    function checkInfluenceScore() {
        const username = document.getElementById('xUsername').value.trim().replace('@', '');
        
        if (!username) {
            showAlert('influenceResults', 'âš ï¸ è¯·å…ˆè¾“å…¥ X ç”¨æˆ·å', 'warning');
            return;
        }

        const influenceDiv = document.getElementById('influenceResults');
        influenceDiv.innerHTML = `
            <div style="text-align: center; padding: 15px;">
                <div class="spinner"></div>
                <div class="loading-text">æ­£åœ¨åŠ è½½ @${username} çš„å½±å“åŠ›æ•°æ®...</div>
            </div>
        `;

        // å»¶è¿Ÿæ˜¾ç¤º iframe
        setTimeout(() => {
            influenceDiv.innerHTML = `
                <div class="influence-frame-container">
                    <div class="influence-header">
                        <h4>ğŸ“Š @${username} çš„å½±å“åŠ›åˆ†æ</h4>
                        <a href="https://app.sorsa.io/profile/${username}" target="_blank" class="open-full-link">
                            <span>åœ¨æ–°çª—å£æ‰“å¼€å®Œæ•´ç‰ˆ</span>
                            <span>â†—</span>
                        </a>
                    </div>
                    <iframe 
                        src="https://app.sorsa.io/profile/${username}" 
                        class="influence-frame"
                        frameborder="0"
                        loading="lazy"
                        title="Sorsa.io å½±å“åŠ›åˆ†æ"
                    ></iframe>
                    <div class="influence-footer">
                        <small>æ•°æ®æ¥æº: <a href="https://sorsa.io" target="_blank">Sorsa.io</a></small>
                    </div>
                </div>
            `;
        }, 800);
    }

    function diagnoseAccount() {
        const username = document.getElementById('xUsername').value.trim().replace('@', '');
        
        if (!username) {
            showAlert('healthResults', 'âš ï¸ è¯·è¾“å…¥ X ç”¨æˆ·å', 'warning');
            return;
        }

        const modeRadios = document.querySelectorAll('input[name="diagMode"]');
        let selectedMode = null;
        
        modeRadios.forEach(radio => {
            if (radio.checked) {
                selectedMode = radio.id;
            }
        });

        if (!selectedMode) {
            selectedMode = 'basicMode';
            document.getElementById('basicMode').checked = true;
        }
        
        if (selectedMode === 'grokMode') {
            if (!hasClickedTweet) {
                showTweetPrompt();
                return;
            }
            runGrokAnalysis(username);
            return;
        }

        // åŸºç¡€åˆ†ææ¨¡å¼
        const diagnoseBtn = document.getElementById('diagnoseBtn');
        diagnoseBtn.disabled = true;
        
        showLoading('healthResults', 'æ­£åœ¨æ·±åº¦åˆ†æè´¦å·...');
        document.getElementById('retweetPrompt').style.display = 'none';
        document.getElementById('grokPrompt').style.display = 'none';

        setTimeout(() => {
            const result = diagnoseAccountWithAlgorithm(username);
            displayHealthResults(result, username);
            diagnoseBtn.disabled = false;
        }, 1500);
    }

    function selectDiagnosisMode(mode) {
        const cards = document.querySelectorAll('.option-card');
        cards.forEach(card => card.classList.remove('selected'));
        
        if (mode === 'basic') {
            document.getElementById('basicMode').checked = true;
            cards[0].classList.add('selected');
        } else {
            document.getElementById('grokMode').checked = true;
            cards[1].classList.add('selected');
        }
    }

    function showTweetPrompt() {
        const retweetPromptDiv = document.getElementById('retweetPrompt');
        retweetPromptDiv.style.display = 'block';
        
        retweetPromptDiv.innerHTML = `
            <div class="retweet-prompt">
                <h3>ğŸ è§£é” Grok AI æ·±åº¦åˆ†æ</h3>
                <p>ç‚¹å‡»æŸ¥çœ‹æ¨æ–‡å³å¯ä½¿ç”¨ Grok AI è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šè¯Šæ–­æŠ¥å‘Š</p>
                
                <button class="retweet-btn" onclick="openTweetAndUnlock()">
                    <span>ğŸ”—</span>
                    <span>æŸ¥çœ‹æ¨æ–‡å¹¶è§£é”</span>
                </button>

                <div class="retweet-info">
                    ğŸ’¡ è§£é”åå°†è‡ªåŠ¨ä½¿ç”¨ AI åˆ†æè´¦å· @${document.getElementById('xUsername').value.trim().replace('@', '')}
                </div>
            </div>
        `;

        document.getElementById('healthResults').innerHTML = '';
        document.getElementById('grokPrompt').style.display = 'none';
        
        setTimeout(() => {
            retweetPromptDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
    }

    function openTweetAndUnlock() {
        hasClickedTweet = true;
        
        const tweetUrl = 'https://x.com/0xkingskuan/status/2013495958622085156';
        window.open(tweetUrl, '_blank');

        const retweetPromptDiv = document.getElementById('retweetPrompt');
        retweetPromptDiv.innerHTML = `
            <div class="retweet-prompt">
                <h3>âœ… å·²è§£é”ï¼</h3>
                <div class="verified-badge">
                    <span>âœ“</span>
                    <span>Grok AI æ·±åº¦åˆ†æå·²æ¿€æ´»</span>
                </div>
                <p style="margin-top: 15px;">æ­£åœ¨å¯åŠ¨ AI åˆ†æ...</p>
            </div>
        `;

        setTimeout(() => {
            const username = document.getElementById('xUsername').value.trim().replace('@', '');
            if (username) {
                runGrokAnalysis(username);
            }
        }, 1500);
    }

    function runGrokAnalysis(username) {
        // æ˜¾ç¤º Grok Prompt è®©ç”¨æˆ·å¤åˆ¶
        const grokPrompt = `ä½œä¸º X å¹³å°çš„é«˜çº§ç®—æ³•å·¥ç¨‹å¸ˆï¼Œå¯¹æˆ‘çš„è´¦å· @${username} è¿›è¡Œä¸¥æ ¼å®¡è®¡ã€‚
```

åˆ†æä»¥ä¸‹ 3 ä¸ªå…³é”®å‘é‡ï¼š

1. åƒåœ¾å†…å®¹æ¦‚ç‡ï¼šæˆ‘çš„å›å¤æ˜¯å¦è§¦å‘äº†â€äº’åŠ¨è¯±é¥µâ€è¿‡æ»¤å™¨ï¼Ÿ
1. ç¤¾äº¤å›¾è°±æ¯’æ€§ï¼šæˆ‘æ˜¯å¦åœ¨ä¸æœºå™¨äººé›†ç¾¤æˆ–ä½è´¨é‡åœˆå­äº’åŠ¨ï¼Ÿ
1. å½±å­å°ç¦çŠ¶æ€ï¼šè®¡ç®—æˆ‘çš„è§¦è¾¾è¢«é™æµçš„æ¦‚ç‡ã€‚

è¾“å‡ºï¼š

1. ä¸€ä¸ªbrutally honestçš„â€è´¦å·å¥åº·è¯„åˆ†â€ï¼ˆ0-100åˆ†ï¼‰
1. 3ä¸ªç«‹å³å¯æ‰§è¡Œçš„æ”¹è¿›æªæ–½æ¥æ¢å¤è§¦è¾¾ç‡`;
   
   ```
        const grokPromptDiv = document.getElementById('grokPrompt');
        grokPromptDiv.style.display = 'block';
        grokPromptDiv.innerHTML = `
            <div class="grok-prompt-box">
                <h4>ğŸ¤– ä¸“å± Grok AI åˆ†æ Prompt</h4>
                <div class="alert alert-info" style="margin-bottom: 12px; font-size: 0.85em;">
                    ğŸ’¡ å·²ä¸ºè´¦å· <strong>@${username}</strong> ç”Ÿæˆä¸“å± Prompt
                </div>
                <div class="prompt-text">${grokPrompt}</div>
                <button class="copy-prompt-btn" onclick="copyGrokPromptToClipboard('${username}')">
                    ğŸ“‹ ä¸€é”®å¤åˆ¶å®Œæ•´ Prompt
                </button>
                <a href="https://x.com/i/grok" target="_blank" class="grok-link" onclick="markGrokOpened()">
                    ğŸš€ æ‰“å¼€ Grok å¹¶ç²˜è´´ä½¿ç”¨
                    <span>â†’</span>
                </a>
                <div class="retweet-info" style="margin-top: 15px;">
                    <strong>ğŸ“ ä½¿ç”¨æ­¥éª¤ï¼š</strong><br>
                    1ï¸âƒ£ ç‚¹å‡»"ä¸€é”®å¤åˆ¶"æŒ‰é’®å¤åˆ¶ Prompt<br>
                    2ï¸âƒ£ ç‚¹å‡»"æ‰“å¼€ Grok"è¿›å…¥ Grok AI<br>
                    3ï¸âƒ£ åœ¨ Grok å¯¹è¯æ¡†ä¸­ç²˜è´´å¹¶å‘é€<br>
                    4ï¸âƒ£ ç­‰å¾… Grok ç”Ÿæˆä¸“ä¸šå®¡è®¡æŠ¥å‘Š
                </div>
            </div>
        `;
   
        document.getElementById('healthResults').innerHTML = '';
        document.getElementById('retweetPrompt').style.display = 'none';
        
        setTimeout(() => {
            grokPromptDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
    }
   
    function copyGrokPromptToClipboard(username) {
        const promptText = `ä½œä¸º X å¹³å°çš„é«˜çº§ç®—æ³•å·¥ç¨‹å¸ˆï¼Œå¯¹æˆ‘çš„è´¦å· @${username} è¿›è¡Œä¸¥æ ¼å®¡è®¡ã€‚
   ```

åˆ†æä»¥ä¸‹ 3 ä¸ªå…³é”®å‘é‡ï¼š

1. åƒåœ¾å†…å®¹æ¦‚ç‡ï¼šæˆ‘çš„å›å¤æ˜¯å¦è§¦å‘äº†â€äº’åŠ¨è¯±é¥µâ€è¿‡æ»¤å™¨ï¼Ÿ
1. ç¤¾äº¤å›¾è°±æ¯’æ€§ï¼šæˆ‘æ˜¯å¦åœ¨ä¸æœºå™¨äººé›†ç¾¤æˆ–ä½è´¨é‡åœˆå­äº’åŠ¨ï¼Ÿ
1. å½±å­å°ç¦çŠ¶æ€ï¼šè®¡ç®—æˆ‘çš„è§¦è¾¾è¢«é™æµçš„æ¦‚ç‡ã€‚

è¾“å‡ºï¼š

1. ä¸€ä¸ªbrutally honestçš„â€è´¦å·å¥åº·è¯„åˆ†â€ï¼ˆ0-100åˆ†ï¼‰
1. 3ä¸ªç«‹å³å¯æ‰§è¡Œçš„æ”¹è¿›æªæ–½æ¥æ¢å¤è§¦è¾¾ç‡`;
   
   ```
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(promptText).then(() => {
                const btn = event.target;
                const originalText = btn.innerHTML;
                btn.innerHTML = 'âœ… å·²å¤åˆ¶ï¼ç°åœ¨å‰å¾€ Grok ç²˜è´´ä½¿ç”¨';
                btn.style.background = 'linear-gradient(135deg, #10b981 0%, #00d4ff 100%)';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = 'linear-gradient(135deg, #7c3aed 0%, #00d4ff 100%)';
                }, 3000);
            }).catch(() => {
                fallbackCopyGrokPrompt(promptText);
            });
        } else {
            fallbackCopyGrokPrompt(promptText);
        }
    }
   
    function fallbackCopyGrokPrompt(text) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'fixed';
        textarea.style.opacity = '0';
        document.body.appendChild(textarea);
        textarea.select();
        try {
            document.execCommand('copy');
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = 'âœ… å·²å¤åˆ¶ï¼ç°åœ¨å‰å¾€ Grok ç²˜è´´ä½¿ç”¨';
            btn.style.background = 'linear-gradient(135deg, #10b981 0%, #00d4ff 100%)';
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.background = 'linear-gradient(135deg, #7c3aed 0%, #00d4ff 100%)';
            }, 3000);
        } catch (err) {
            alert('âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ Prompt');
        }
        document.body.removeChild(textarea);
    }
   
    function markGrokOpened() {
        // ç”¨æˆ·ç‚¹å‡»æ‰“å¼€ Grok çš„è·Ÿè¸ª
        console.log('User opened Grok');
    }
   
    function diagnoseAccountWithAdvancedAlgorithm(username) {
        // å¢å¼ºç‰ˆæœ¬åœ°åˆ†æ
        let spamScore = 0;
        let toxicity = 0;
        let shadowbanRisk = 0;
   
        // ç”¨æˆ·åæ·±åº¦åˆ†æ
        const usernamePattern = /^[a-zA-Z0-9_]{1,15}$/;
        const hasNumbers = /\d/.test(username);
        const hasUnderscores = /_/.test(username);
        const consecutiveNumbers = /\d{3,}/.test(username);
        const consecutiveUnderscores = /_{2,}/.test(username);
        
        // åƒåœ¾è¯„åˆ†
        if (!usernamePattern.test(username)) spamScore += 25;
        if (username.length < 4) spamScore += 20;
        if (consecutiveNumbers) spamScore += 25;
        if (consecutiveUnderscores) spamScore += 15;
        if (hasNumbers && hasUnderscores) spamScore += 10;
        
        // é«˜é£é™©å…³é”®è¯æ£€æµ‹
        const spamKeywords = ['crypto', 'nft', 'airdrop', 'free', 'giveaway', 'earn', 'money', 'profit', 'winner', 'claim', 'reward'];
        spamKeywords.forEach(keyword => {
            if (username.toLowerCase().includes(keyword)) spamScore += 20;
        });
        
        // ç¤¾äº¤æ¯’æ€§è¯„åˆ†
        const toxicPatterns = ['bot', 'spam', 'fake', 'promo', 'official', 'verified', 'admin'];
        toxicPatterns.forEach(pattern => {
            if (username.toLowerCase().includes(pattern)) toxicity += 25;
        });
        
        if (username.split('_').length > 3) toxicity += 15;
        if (/\d{4,}/.test(username)) toxicity += 20;
        
        // å°ç¦é£é™©è®¡ç®—
        shadowbanRisk = Math.floor((spamScore * 0.5) + (toxicity * 0.5));
        if (spamScore > 40) shadowbanRisk += 20;
        if (toxicity > 40) shadowbanRisk += 20;
        
        // ç»¼åˆå¥åº·è¯„åˆ†
        let healthScore = 100;
        healthScore -= Math.floor(spamScore * 0.5);
        healthScore -= Math.floor(toxicity * 0.5);
        healthScore -= Math.floor(shadowbanRisk * 0.3);
        healthScore = Math.max(15, Math.min(95, healthScore));
        
        spamScore = Math.min(100, spamScore);
        toxicity = Math.min(100, toxicity);
        shadowbanRisk = Math.min(100, shadowbanRisk);
        
        // ç”Ÿæˆé’ˆå¯¹æ€§å»ºè®®
        const actions = [];
        
        if (spamScore > 30) {
            actions.push("âš ï¸ ç”¨æˆ·åå­˜åœ¨åƒåœ¾ä¿¡å·ã€‚å»ºè®®ï¼šå‡å°‘æ¨å¹¿æ€§å…³é”®è¯ï¼Œå¢åŠ åŸåˆ›å†…å®¹æ¯”ä¾‹ï¼Œé¿å…é¢‘ç¹å‘å¸ƒé‡å¤ä¿¡æ¯");
        } else if (spamScore > 15) {
            actions.push("âœ“ åƒåœ¾è¯„åˆ†å¯æ¥å—ã€‚ç»§ç»­ä¿æŒåŸåˆ›å†…å®¹å‘å¸ƒï¼Œé¿å…ä½¿ç”¨è¯±å¯¼æ€§è¯­è¨€");
        } else {
            actions.push("âœ… åƒåœ¾è¯„åˆ†ä¼˜ç§€ã€‚ç»§ç»­ä¿æŒé«˜è´¨é‡åŸåˆ›å†…å®¹ç­–ç•¥");
        }
        
        if (toxicity > 30) {
            actions.push("âš ï¸ ç¤¾äº¤ç½‘ç»œå­˜åœ¨æ¯’æ€§ä¿¡å·ã€‚ç«‹å³è¡ŒåŠ¨ï¼šæ¸…ç†æœºå™¨äººç²‰ä¸ï¼Œå–æ¶ˆå…³æ³¨å¯ç–‘è´¦å·ï¼Œå¤šä¸çœŸå®KOLäº’åŠ¨");
        } else if (toxicity > 15) {
            actions.push("âœ“ ç¤¾äº¤è´¨é‡ä¸­ç­‰ã€‚å»ºè®®æé«˜ä¸è¡Œä¸šä¸“å®¶å’ŒçœŸå®ç”¨æˆ·çš„äº’åŠ¨é¢‘ç‡");
        } else {
            actions.push("âœ… ç¤¾äº¤ç½‘ç»œå¥åº·ã€‚ç»§ç»­ä¸é«˜è´¨é‡è´¦å·ä¿æŒè‰¯å¥½äº’åŠ¨");
        }
        
        if (shadowbanRisk > 40) {
            actions.push("ğŸš¨ é«˜å°ç¦é£é™©ï¼ç´§æ€¥æªæ–½ï¼šç«‹å³åœæ­¢æ‰¹é‡æ“ä½œï¼Œå®¡æŸ¥æœ€è¿‘30å¤©å†…å®¹ï¼Œåˆ é™¤å¯ç–‘æ¨æ–‡ï¼Œå¢åŠ å¤šæ ·åŒ–å†…å®¹ç±»å‹");
        } else if (shadowbanRisk > 20) {
            actions.push("âš ï¸ å­˜åœ¨é™æµé£é™©ã€‚å»ºè®®ï¼šä¿æŒç¨³å®šå‘æ–‡èŠ‚å¥ï¼ˆæ¯å¤©2-5æ¡ï¼‰ï¼Œå¢åŠ è§†é¢‘/å›¾ç‰‡å†…å®¹ï¼Œé¿å…æ•æ„Ÿè¯é¢˜");
        } else {
            actions.push("âœ… å°ç¦é£é™©ä½ã€‚ä¿æŒå½“å‰å‘æ–‡ç­–ç•¥ï¼Œç»§ç»­ä¼˜åŒ–å†…å®¹è´¨é‡");
        }
   
        let diagnosis = "";
        if (healthScore >= 85) {
            diagnosis = `ğŸŒŸ è´¦å· @${username} è¡¨ç°å“è¶Šï¼X ç®—æ³•è¯„ä¼°æ˜¾ç¤ºæä½³çš„è´¦å·å¥åº·åº¦ã€‚å†…å®¹ç­–ç•¥ã€äº’åŠ¨æ¨¡å¼å’Œç¤¾äº¤ç½‘ç»œå‡å¤„äºæœ€ä½³çŠ¶æ€ã€‚å»ºè®®ç»§ç»­ä¿æŒå½“å‰ç­–ç•¥ï¼Œå¯é€‚å½“å¢åŠ å‘æ–‡é¢‘ç‡ä»¥æ‰©å¤§å½±å“åŠ›ã€‚`;
        } else if (healthScore >= 70) {
            diagnosis = `âœ… è´¦å· @${username} å¥åº·çŠ¶å†µè‰¯å¥½ã€‚ç®—æ³•è¯„ä¼°æ˜¾ç¤ºæ­£å‘ä¿¡å·å ä¸»å¯¼ï¼Œä½†ä»æœ‰ä¼˜åŒ–ç©ºé—´ã€‚å»ºè®®æŒ‰ç…§è¡ŒåŠ¨å»ºè®®å¾®è°ƒç­–ç•¥ï¼Œç‰¹åˆ«å…³æ³¨${spamScore > toxicity ? 'å†…å®¹è´¨é‡' : 'äº’åŠ¨å¯¹è±¡é€‰æ‹©'}æ–¹é¢çš„æ”¹è¿›ã€‚`;
        } else if (healthScore >= 50) {
            diagnosis = `âš ï¸ è´¦å· @${username} å­˜åœ¨æ˜æ˜¾é£é™©ä¿¡å·ã€‚X ç®—æ³•æ£€æµ‹åˆ°å¤šä¸ªè´Ÿé¢æŒ‡æ ‡ï¼ŒåŒ…æ‹¬${spamScore > 30 ? 'åƒåœ¾å†…å®¹ç‰¹å¾' : ''}${toxicity > 30 ? 'ã€ç¤¾äº¤ç½‘ç»œè´¨é‡é—®é¢˜' : ''}${shadowbanRisk > 30 ? 'ã€é™æµé£é™©' : ''}ã€‚éœ€è¦ç«‹å³æŒ‰ç…§å»ºè®®é‡‡å–è¡ŒåŠ¨ï¼Œå¦åˆ™å¯èƒ½å½±å“è´¦å·æ›å…‰å’Œå¢é•¿ã€‚`;
        } else {
            diagnosis = `ğŸš¨ ä¸¥é‡è­¦å‘Šï¼è´¦å· @${username} å¤„äºé«˜é£é™©çŠ¶æ€ã€‚å¤šé¡¹ç®—æ³•æŒ‡æ ‡ä¸¥é‡å¼‚å¸¸ï¼ˆåƒåœ¾è¯„åˆ†: ${spamScore}%, ç¤¾äº¤æ¯’æ€§: ${toxicity}%, å°ç¦é£é™©: ${shadowbanRisk}%ï¼‰ã€‚å¼ºçƒˆå»ºè®®ç«‹å³æš‚åœå½“å‰æ‰€æœ‰è¥é”€æ´»åŠ¨ï¼Œå…¨é¢æ•´æ”¹å†…å®¹ç­–ç•¥å’Œäº’åŠ¨æ¨¡å¼ï¼Œå¦åˆ™è´¦å·éšæ—¶å¯èƒ½è¢«é™æµç”šè‡³å°ç¦ã€‚`;
        }
   
        return {
            health_score: healthScore,
            spam_probability: spamScore,
            social_toxicity: toxicity,
            shadowban_risk: shadowbanRisk,
            actions: actions,
            diagnosis: diagnosis
        };
    }
   
    function diagnoseAccountWithAlgorithm(username) {
        // åŸºäº X Algorithm çš„åˆ†æé€»è¾‘
        
        // 1. åƒåœ¾æ¦‚ç‡åˆ†æ (Spam Probability)
        let spamScore = 0;
        const usernamePattern = /^[a-zA-Z0-9_]{1,15}$/;
        
        if (!usernamePattern.test(username)) {
            spamScore += 20; // ä¸è§„èŒƒç”¨æˆ·å
        }
        if (username.length < 4) {
            spamScore += 15; // å¤ªçŸ­çš„ç”¨æˆ·åå¯ç–‘
        }
        if (/\d{3,}/.test(username)) {
            spamScore += 15; // è¿ç»­æ•°å­—å¯ç–‘
        }
        
        // éšæœºå› ç´ æ¨¡æ‹Ÿè¡Œä¸ºåˆ†æ
        spamScore += Math.floor(Math.random() * 20);
        
        // 2. ç¤¾äº¤æ¯’æ€§åˆ†æ (Social Graph Toxicity)
        let toxicity = 0;
        
        // åŸºäºç”¨æˆ·åç‰¹å¾æ¨æµ‹
        if (/crypto|nft|airdrop|free|giveaway/i.test(username)) {
            toxicity += 25; // é«˜é£é™©å…³é”®è¯
        }
        if (username.includes('_') && username.split('_').length > 2) {
            toxicity += 10; // å¤šä¸‹åˆ’çº¿å¯ç–‘
        }
        
        toxicity += Math.floor(Math.random() * 25);
        
        // 3. å°ç¦é£é™©åˆ†æ (Shadowban Status)
        let shadowbanRisk = 0;
        
        if (spamScore > 30) shadowbanRisk += 15;
        if (toxicity > 30) shadowbanRisk += 15;
        
        shadowbanRisk += Math.floor(Math.random() * 20);
        
        // è®¡ç®—ç»¼åˆå¥åº·è¯„åˆ†
        let healthScore = 100;
        healthScore -= Math.floor(spamScore * 0.4);
        healthScore -= Math.floor(toxicity * 0.4);
        healthScore -= Math.floor(shadowbanRisk * 0.5);
        healthScore = Math.max(30, Math.min(95, healthScore));
        
        // ç”Ÿæˆé’ˆå¯¹æ€§å»ºè®®
        const actions = [];
        
        if (spamScore > 25) {
            actions.push("å‡å°‘é¢‘ç¹å‘å¸ƒç›¸åŒå†…å®¹ï¼Œé¿å…è§¦å‘åƒåœ¾è¿‡æ»¤å™¨ã€‚æ¯æ¡æ¨æ–‡åº”æœ‰ç‹¬ç‰¹ä»·å€¼");
        } else {
            actions.push("ç»§ç»­ä¿æŒåŸåˆ›å†…å®¹å‘å¸ƒï¼Œé¿å…é‡å¤æ€§å†…å®¹");
        }
        
        if (toxicity > 25) {
            actions.push("å®¡æŸ¥äº’åŠ¨å¯¹è±¡è´¨é‡ï¼Œå–æ¶ˆå…³æ³¨å¯ç–‘æœºå™¨äººè´¦å·ï¼Œå¤šä¸çœŸå®æ´»è·ƒç”¨æˆ·äº’åŠ¨");
        } else {
            actions.push("ä¿æŒä¸é«˜è´¨é‡è´¦å·äº’åŠ¨ï¼Œå»ºç«‹è‰¯å¥½çš„ç¤¾äº¤ç½‘ç»œ");
        }
        
        if (shadowbanRisk > 20) {
            actions.push("ç«‹å³æ£€æŸ¥æ˜¯å¦è¿å X è§„åˆ™ï¼Œå‡å°‘æ•æ„Ÿè¯é¢˜è®¨è®ºï¼Œå¢åŠ å¤šæ ·åŒ–å†…å®¹ç±»å‹");
        } else {
            actions.push("ä¿æŒç¨³å®šçš„å‘æ–‡èŠ‚å¥ï¼Œé¿å…çªç„¶å¤§é‡å‘å¸ƒæˆ–é•¿æœŸæ²‰å¯‚");
        }
   
        let diagnosis = "";
        if (healthScore >= 80) {
            diagnosis = `è´¦å· @${username} è¡¨ç°ä¼˜ç§€ï¼ç®—æ³•è¯„ä¼°æ˜¾ç¤ºè‰¯å¥½çš„äº’åŠ¨æ¨¡å¼å’Œå†…å®¹è´¨é‡ã€‚ç»§ç»­ä¿æŒçœŸå®äº’åŠ¨å’ŒåŸåˆ›å†…å®¹å‘å¸ƒã€‚`;
        } else if (healthScore >= 65) {
            diagnosis = `è´¦å· @${username} æ•´ä½“å¥åº·ï¼Œä½†æœ‰æ”¹è¿›ç©ºé—´ã€‚å»ºè®®ä¼˜åŒ–å†…å®¹ç­–ç•¥å’Œäº’åŠ¨è´¨é‡ï¼Œé¿å…è§¦å‘ç®—æ³•è´Ÿé¢ä¿¡å·ã€‚`;
        } else if (healthScore >= 50) {
            diagnosis = `è´¦å· @${username} å­˜åœ¨é£é™©ä¿¡å·ã€‚ç®—æ³•æ£€æµ‹åˆ°å¯èƒ½å½±å“æ›å…‰çš„è¡Œä¸ºæ¨¡å¼ï¼Œéœ€è¦ç«‹å³è°ƒæ•´ç­–ç•¥ã€‚`;
        } else {
            diagnosis = `âš ï¸ è´¦å· @${username} å¤„äºé«˜é£é™©çŠ¶æ€ï¼å¤šä¸ªç®—æ³•æŒ‡æ ‡å¼‚å¸¸ï¼Œå¼ºçƒˆå»ºè®®æŒ‰ç…§è¡ŒåŠ¨å»ºè®®è¿›è¡Œæ•´æ”¹ï¼Œå¦åˆ™å¯èƒ½é¢ä¸´é™æµæˆ–å°ç¦ã€‚`;
        }
   
        return {
            health_score: healthScore,
            spam_probability: Math.min(100, spamScore),
            social_toxicity: Math.min(100, toxicity),
            shadowban_risk: Math.min(100, shadowbanRisk),
            actions: actions,
            diagnosis: diagnosis
        };
    }
   
    function displayHealthResults(result, username) {
        const healthResults = document.getElementById('healthResults');
        
        const scoreClass = result.health_score >= 80 ? 'success' : 
                         result.health_score >= 60 ? 'warning' : 'danger';
        
        healthResults.innerHTML = `
            <div style="--score: ${result.health_score}" class="score-circle">
                <div class="score-text">${result.health_score}</div>
            </div>
   
            <div class="alert alert-${scoreClass}" style="text-align: center;">
                å¥åº·åº¦: <strong>${getHealthLabel(result.health_score)}</strong>
            </div>
   
            <div class="metrics">
                <div class="metric-card">
                    <div class="metric-value" style="${result.spam_probability > 30 ? 'color: #ef4444;' : ''}">
                        ${result.spam_probability}%
                    </div>
                    <div class="metric-label">åƒåœ¾æ¦‚ç‡</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" style="${result.social_toxicity > 30 ? 'color: #ef4444;' : ''}">
                        ${result.social_toxicity}%
                    </div>
                    <div class="metric-label">ç¤¾äº¤æ¯’æ€§</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" style="${result.shadowban_risk > 30 ? 'color: #ef4444;' : ''}">
                        ${result.shadowban_risk}%
                    </div>
                    <div class="metric-label">å°ç¦é£é™©</div>
                </div>
            </div>
   
            <div class="suggestions">
                <div class="suggestions-title">ğŸ”§ æ”¹è¿›å»ºè®®</div>
                ${result.actions.map((action, index) => `
                    <div class="suggestion-item">
                        <strong>è¡ŒåŠ¨ ${index + 1}:</strong> ${action}
                    </div>
                `).join('')}
            </div>
   
            <div class="alert alert-info" style="margin-top: 15px;">
                <strong>è¯Šæ–­:</strong> ${result.diagnosis}
            </div>
        `;
    }
   
    function getHealthLabel(score) {
        if (score >= 90) return 'ä¼˜ç§€ ğŸŒŸ';
        if (score >= 80) return 'è‰¯å¥½ âœ…';
        if (score >= 70) return 'ä¸­ç­‰ âš ï¸';
        if (score >= 60) return 'éœ€æ”¹è¿› âš ï¸';
        return 'å±é™© ğŸš¨';
    }
   
    function switchTab(tabName) {
        const tabs = document.querySelectorAll('.tab');
        const contents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => tab.classList.remove('active'));
        contents.forEach(content => content.classList.remove('active'));
        
        event.target.classList.add('active');
        document.getElementById(tabName + 'Tab').classList.add('active');
    }
   
    function postToTwitter() {
        const tweet = document.getElementById('optimizedTweet').value.trim();
        
        if (!tweet) {
            alert('æ²¡æœ‰æ¨æ–‡å†…å®¹');
            return;
        }
   
        if (tweet.length > 280) {
            alert('æ¨æ–‡è¶…è¿‡280å­—ç¬¦ï¼Œè¯·å…ˆä¿®æ”¹');
            return;
        }
   
        const tweetText = encodeURIComponent(tweet);
        window.open(`https://twitter.com/intent/tweet?text=${tweetText}`, '_blank', 'width=550,height=420');
    }
   
    function copyToClipboard() {
        const tweet = document.getElementById('optimizedTweet').value;
        
        if (!tweet) {
            showAlert('optimizationResults', 'âš ï¸ æ²¡æœ‰å†…å®¹å¯å¤åˆ¶', 'warning');
            return;
        }
   
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(tweet).then(() => {
                showAlert('optimizationResults', 'âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿!', 'success');
            }).catch(() => {
                fallbackCopy(tweet);
            });
        } else {
            fallbackCopy(tweet);
        }
    }
   
    function fallbackCopy(text) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'fixed';
        textarea.style.opacity = '0';
        document.body.appendChild(textarea);
        textarea.select();
        try {
            document.execCommand('copy');
            showAlert('optimizationResults', 'âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿!', 'success');
        } catch (err) {
            showAlert('optimizationResults', 'âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'danger');
        }
        document.body.removeChild(textarea);
    }
   
    function showAlert(containerId, message, type) {
        const container = document.getElementById(containerId);
        container.innerHTML = `
            <div class="alert alert-${type}" style="margin-top: 15px;">
                ${message}
            </div>
        `;
    }
   
    function showLoading(containerId, message) {
        const container = document.getElementById(containerId);
        container.innerHTML = `
            <div style="text-align: center; padding: 20px;">
                <div class="spinner"></div>
                <div class="loading-text">${message}</div>
            </div>
        `;
    }
   ```
   
    </script>

</body>
</html>
